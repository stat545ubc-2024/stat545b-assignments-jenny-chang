---
title: "assignment_b1"
author: "STAT545"
date: "2024-10-24"
output: html_document
---

# Load data ---------------------------
```{r}
library(tidyverse)
library(gapminder)
```


# Build function ----------------------
Define a function to count the number of unique values in summ_var grouped by group_var
```{r}
count_unique <- function(data, group_var, summ_var, .groups = "drop") {
  data %>%
    group_by({{ group_var }}) %>%
    summarize(unique_sum = n_distinct({{ summ_var }}), .groups = .groups)
}

# Example usage
count_unique(gapminder, continent, country, .groups = "keep")
```


# Example usage
get_unique_values("continent") # Get unique continent
get_unique_values("country")   # Get unique countries
get_unique_values("year")      # Get unique years

# Example usage
get_unique_values(country, continent)  # Get unique countries per continent
get_unique_values(year, continent)     # Get unique years per continent




library(palmerpenguins)

#change this to be more generalizable
summarize_missing_values <- function(data) {
  data %>%
    group_by(species) %>%
    summarize(across(everything(), ~ sum(is.na(.x))))
}

summarize_missing_values(penguins)

#replace species
summarize_missing_values <- function(data, group_var) {
  data %>%
    group_by({{group_var}}) %>%
    summarize(across(everything(), ~ sum(is.na(.x))))
}

summarize_missing_values(penguins, species)

#replace aross(everything)
summarize_missing_values <- function(data, group_var, summ_vars) {
  data %>%
    group_by({{group_var}}) %>%
    summarize(across({{summ_vars}}, ~ sum(is.na(.x))))
}

summarize_missing_values(penguins, species, c(body_mass_g, bill_length_mm))

#dropping groups by default
summarize_missing_values <- function(data, ..., summ_vars, .groups = "drop") {
  data %>%
    group_by(...) %>%
    summarize(across({{summ_vars}}, ~ sum(is.na(.x))), .groups = .groups)
}

summarize_missing_values(penguins, species, island, summ_vars = c(body_mass_g, bill_length_mm))



# Plot data ---------------------------

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
